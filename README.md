# Flaschenpost

## SQL TASK

We have the following tables:

Orders:
![image](https://user-images.githubusercontent.com/76171282/170987684-f384fe4a-8c5a-422b-a6ae-54df4cc81d7b.png)

This table consists of all versions of all orders made by the customers. This table is
versioned, which means that when one order is changed (for example additional
quantities are added to an order) a new row is added to this table (order_id is the same
across different versions) and valid_from date is set to the time of when the change
happened, while valid_to of the previous version is set to the same time. Valid_to of the
new version is set to a generic future datetime ‘9999-01-01 23:59:00’.

Positions:
![image](https://user-images.githubusercontent.com/76171282/170987866-800042b3-aba5-426d-8288-7548014ced10.png)

This table contains information about the quantities and prices of products that are part
of each order.
1. Write one or more queries in order to create a table with the last version of
each order.
2. Your task is to prepare data that can be used by other teams. These
teams don’t know how to use SQL, but can use data visualization tools in which
sorting, filtering and grouping can be done (but not joining or unions of tables).
Other teams are interested in finding out quantities of each wine sold in a specific
time period, total revenue generated by these orders and margin
(1-netto_netto_price/price). Write one or more queries in order to produce
table(s) that can be used by other teams.
Bonus: How would you automate a previous solution? (If you worked with Google
Cloud you can describe the process in more detail, but if not, just describing
algorithmical steps is ok)


## PROGRAMMING TASK

How would you rate your programming skills? 1 - 5 (1 - no knowledge at all; 5 -
excellent skills)

Can you write a function in your language of choice (or describe approach
algorithmically) that will solve the first problem in SQL task?
